<div class="container">
  <h2><%= @movie.title %></h2>
  <p>Genre: <%= @movie.genre %></p>
  <p>Plot: <%= @movie.plot %></p>
  <p>Director: <%= @movie.director %></p>
  <p>Cast: <%= @movie.cast %></p>
  <p>Year: <%= @movie.year %></p>
  <p>Number of favorites: <%= @movie.favorites.count %></p>
</div>

<div class="review-container container">
  <% if @movie.reviews.any? %>
    <h3>Reviews:</h3>
    <% @movie.reviews.each do |review| %>
      <p> <span>Rating: <%= review.rating %></span> | <%= review.comment %> </p>
    <% end %>
    <p>Average Rating: <%= @movie.average_rating %></p>
  <% end %>

  <% if logged_in? %>
    <% if current_user.favorite_movies.exists?(@movie) %>
      <%= link_to 'Unfavorite', favorite_path(@movie.favorites.find_by(user: current_user)), method: :delete %>
    <% else %>
      <%= form_for([@movie, @movie.favorites.build]) do |f| %>
        <p>
          <%= f.submit "Favorite" %>
        </p>
      <% end %>
    <% end %>
    <%= link_to "New Review", new_movie_review_path(@movie) %>
  <% end %>
</div>
